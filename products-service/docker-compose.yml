services:
  products:
    image: node:18-alpine
    working_dir: /app
    volumes: [ "./:/app" ]
    command: ["npm", "start"]
    env_file: [ ".env" ]
    ports: [ "13002:3002" ]
    depends_on: [ products_db ]
    restart: unless-stopped

  products_db:
    image: mysql:8.0
    environment:
      MYSQL_ROOT_PASSWORD: "${DB_PASSWORD:-root}"
      MYSQL_DATABASE: "${DB_NAME:-products_db}"
    ports: [ "13307:3306" ]
    command: ["--default-authentication-plugin=mysql_native_password"]
    volumes: [ "products_db_data:/var/lib/mysql" ]
    restart: unless-stopped

  mongo_logs:
    image: mongo:6
    ports: [ "27028:27017" ]
    volumes: [ "products_mongo_data:/data/db" ]
    restart: unless-stopped

volumes:
  products_db_data:
  products_mongo_data:
